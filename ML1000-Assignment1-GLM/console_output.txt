> data$day = as.ordered(data$day)
> data$weekday = as.ordered(data$weekday)
> data$hour = as.ordered(data$hour)
> data$did_crash_happen = as.factor(
+   ifelse(data$did_crash_happen == 0, "no", "yes")
+ )
> testData = data[data$timestamp > '2019-01-27 00:00:00']
Error in `[.data.frame`(data, data$timestamp > "2019-01-27 00:00:00") : 
  undefined columns selected
> View(data)
> testData = data[data$timestamp > '2019-01-27']
Error in `[.data.frame`(data, data$timestamp > "2019-01-27") : 
  undefined columns selected
> motor_collision_crash_clean_data <- read.csv("C:\\Users\\Alex Fung\\Documents\\CSML1000\\CSML1000-Group-10-assignment-1\\data\\motor_vehicle_collisions_crashes_cleaned.csv")
> View(motor_collision_crash_clean_data)
> #data <- select(motor_collision_crash_clean_data, -c(id, timestamp, total_number_of_crashes))
> data <- select(motor_collision_crash_clean_data, -c(id, total_number_of_crashes))
> View(data)
> #set columns as appropriate
> data$timestamp = as.Date(data$timestamp)
> View(data)
> data$precinct = as.factor(data$precinct)
> data$month = as.ordered(data$month)
> data$week = as.ordered(data$week)
> data$day = as.ordered(data$day)
> data$weekday = as.ordered(data$weekday)
> data$hour = as.ordered(data$hour)
> data$did_crash_happen = as.factor(
+   ifelse(data$did_crash_happen == 0, "no", "yes")
+ )
> #separate data into train and test
> #because we run into memory issues
> #trainData will be two years' worth, from 2017 Jan to 2019 Jan
> #testData will be from 2019 Jan onwards
> #a separate 'trainData_older' will be all the data from 2017 Jan and before
> trainData_older = data[data$timestamp < '2017-01-27', ]
> trainData = data[data$timestamp > '2017-01-27' & data$timestamp < '2019-01-27', ]
> testData = data[data$timestamp > '2019-01-27']
Error in `[.data.frame`(data, data$timestamp > "2019-01-27") : 
  undefined columns selected
> testData = data[data$timestamp > '2019-01-27', ]
> pred.model_glm.prob = predict(model_glm, newdata = testData, type="prob")
> pred.model_glm.raw = predict(model_glm, newdata = testData)
> pred.model_glm.prob[, "yes"]
   [1] 0.4798429 0.2651625 0.2035290 0.1886297 0.2117387 0.2369302 0.3469716
   [8] 0.4403431 0.5981729 0.5957930 0.5794959 0.5947335 0.6166759 0.6291553
  [15] 0.6725282 0.6558738 0.6888968 0.6845111 0.6409483 0.5807894 0.5188386
  [22] 0.4713129 0.4487351 0.3887473 0.4852114 0.2693730 0.2070366 0.1919424
  [29] 0.2153495 0.2408393 0.3518591 0.4456484 0.6033297 0.6009600 0.5847260
  [36] 0.5999050 0.6217454 0.6341577 0.6772457 0.6607101 0.6934859 0.6891358
  [43] 0.6458811 0.5860149 0.5242038 0.4766734 0.4540594 0.3938684 0.4884502
  [50] 0.2719321 0.2091730 0.1939611 0.2175482 0.2432176 0.3548213 0.4488533
  [57] 0.6064281 0.6040648 0.5878704 0.6030125 0.6247894 0.6371601 0.6800729
  [64] 0.6636102 0.6962347 0.6919062 0.6488406 0.5891565 0.5274361 0.4799083
  [71] 0.4572750 0.3969676 0.5060741 0.2861132 0.2210750 0.2052222 0.2297883
  [78] 0.2564286 0.3711216 0.4663510 0.6231236 0.6207978 0.6048402 0.6197620
  [85] 0.6411669 0.6532972 0.6952145 0.6791633 0.7109364 0.7067292 0.6647316
  [92] 0.6061087 0.5449682 0.4975238 0.4748181 0.4139618 0.5143933 0.2929612
  [99] 0.2268610 0.2107056 0.2357334 0.2628277 0.3789243 0.4746447 0.6309091
 [106] 0.6286028 0.6127687 0.6275755 0.6487898 0.6607988 0.7022224 0.6863739
 [113] 0.7177297 0.7135815 0.6721099 0.6140280 0.5532106 0.5058463 0.4831260
 [120] 0.4220606 0.4818946 0.2667671 0.2048646 0.1898908 0.2131137 0.2384193
 [127] 0.3488362 0.4423696 0.6001468 0.5977707 0.5814973 0.5967129 0.6186168
 [134] 0.6310708 0.6743357 0.6577264 0.6906555 0.6862833 0.6428375 0.5827891
 [141] 0.5208901 0.4733613 0.4507691 0.3907020 0.4408186 0.2356866 0.1792333
 [148] 0.1657424 0.1866927 0.2096971 0.3122661 0.4020482 0.5598835 0.5574447
 [155] 0.5407931 0.5563595 0.5789085 0.5918036 0.6370247 0.6195860 0.6542556
 [162] 0.6496300 0.6040368 0.5421116 0.4795668 0.4324056 0.4102454 0.3521164
 [169] 0.4829662 0.2676073 0.2055645 0.1905518 0.2138343 0.2391994 0.3498116
 [176] 0.4434285 0.6011762 0.5988022 0.5825413 0.5977452 0.6196288 0.6320694
 [183] 0.6752775 0.6586919 0.6915716 0.6872066 0.6438222 0.5838322 0.5219610
 [190] 0.4744312 0.4518318 0.3917241 0.5000019 0.2811778 0.2169206 0.2012888
 [197] 0.2255176 0.2518247 0.3654705 0.4603112 0.6174025 0.6150632 0.5990201
 [204] 0.6140215 0.6355595 0.6477753 0.6900433 0.6738477 0.7059192 0.7016696
 [211] 0.6592968 0.6002950 0.5389385 0.4914521 0.4687650 0.4080817 0.4891720
 [218] 0.2725044 0.2096512 0.1944131 0.2180403 0.2437497 0.3554828 0.4495680
 [225] 0.6071174 0.6047555 0.5885701 0.6037038 0.6254664 0.6378277 0.6807011
 [232] 0.6642548 0.6968453 0.6925216 0.6494985 0.5898555 0.5281561 0.4806293
 [239] 0.4579919 0.3976593 0.5070287 0.2868939 0.2217334 0.2058459 0.2304650
 [246] 0.2571575 0.3720134 0.4673015 0.6240200 0.6216965 0.6057526 0.6206616
 [253] 0.6420451 0.6541617 0.6960231 0.6799950 0.7117206 0.7075201 0.6655822
 [260] 0.6070201 0.5459150 0.4984785 0.4757706 0.4148886 0.5255251 0.3022840
 [267] 0.2347789 0.2182187 0.2438632 0.2715599 0.3894758 0.4857768 0.6412329
 [274] 0.6389541 0.6232969 0.6379390 0.6588838 0.6707228 0.7114637 0.6958940
 [281] 0.7266771 0.7226095 0.6818623 0.6245430 0.5642065 0.5169901 0.4942700
 [288] 0.4329759 0.4840176 0.2684333 0.2062529 0.1912021 0.2145430 0.2399665
 [295] 0.3507698 0.4444678 0.6021852 0.5998132 0.5835649 0.5987572 0.6206207
 [302] 0.6330480 0.6762000 0.6596378 0.6924690 0.6881109 0.6447871 0.5848548
 [309] 0.5230115 0.4754812 0.4528748 0.3927278 0.4491041 0.2417836 0.1842219
 [316] 0.1704335 0.1918404 0.2153111 0.3195160 0.4101395 0.5681332 0.5657046
 [323] 0.5491124 0.5646239 0.5870646 0.5998825 0.6447459 0.6274612 0.6618048
 [330] 0.6572273 0.6120323 0.5504269 0.4879451 0.4406576 0.4183862 0.3598074
 [337] 0.4929560 0.2755163 0.2121711 0.1967954 0.2206328 0.2465515 0.3589594
 [344] 0.4533175 0.6107229 0.6083687 0.5922316 0.6073205 0.6290064 0.6413179
 [351] 0.6839828 0.6676230 0.7000342 0.6957362 0.6529375 0.5935134 0.5319276
 [358] 0.4844099 0.4617528 0.4012915 0.4968066 0.2786017 0.2147573 0.1992417
 [365] 0.2232930 0.2494242 0.3625116 0.4571376 0.6143788 0.6120327 0.5959462
 [372] 0.6109879 0.6325939 0.6448535 0.6873030 0.6710324 0.7032589 0.6989872
 [379] 0.6564199 0.5972243 0.5357609 0.4882580 0.4655834 0.4049980 0.5066280
 [386] 0.2865660 0.2214569 0.2055839 0.2301808 0.2568514 0.3716389 0.4669025
 [393] 0.6236438 0.6213193 0.6053697 0.6202841 0.6416766 0.6537990 0.6956838
 [400] 0.6796460 0.7113916 0.7071883 0.6652253 0.6066376 0.5455176 0.4980777
 [407] 0.4753707 0.4144995 0.5140931 0.2927123 0.2266503 0.2105058 0.2355169
 [414] 0.2625949 0.3786415 0.4743450 0.6306292 0.6283222 0.6124835 0.6272946
 [421] 0.6485159 0.6605293 0.7019711 0.6861151 0.7174861 0.7133358 0.6718450
 [428] 0.6137432 0.5529135 0.5055459 0.4828260 0.4217675 0.5407049 0.3153006
 [435] 0.2459131 0.2288024 0.2552845 0.2837916 0.4040724 0.5010208 0.6551401
 [442] 0.6529018 0.6375063 0.6519045 0.6724563 0.6840501 0.7238210 0.7086451
 [449] 0.7386222 0.7346675 0.6949438 0.6387326 0.5791398 0.5321999 0.5095164
 [456] 0.4480066 0.4942443 0.2765463 0.2130338 0.1976114 0.2215203 0.2475101
 [463] 0.3601462 0.4545951 0.6119475 0.6095960 0.5934756 0.6085489 0.6302084
 [470] 0.6425026 0.6850958 0.6687657 0.7011154 0.6968262 0.6541045 0.5947562
 [477] 0.5332106 0.4856972 0.4630340 0.4025304 0.4523080 0.2441640 0.1861748
 [484] 0.1722711 0.1938549 0.2175057 0.3223364 0.4132740 0.5713057 0.5688814
 [491] 0.5523145 0.5678025 0.5901983 0.6029847 0.6477046 0.6304813 0.6646953
 [498] 0.6601368 0.6151008 0.5536272 0.4911791 0.4438498 0.4215387 0.3627938
 [505] 0.4687061 0.2565508 0.1963840 0.1818883 0.2043795 0.2289497 0.3369211
 [512] 0.4293663 0.5873910 0.5849916 0.5685743 0.5839236 0.6060635 0.6186748
 [519] 0.6626162 0.6457232 0.6792439 0.6747864 0.6306054 0.5698765 0.5076801
 [526] 0.4601988 0.4377127 0.3781875 0.4794426 0.2648501 0.2032691 0.1883844
 [533] 0.2114712 0.2366404 0.3466083 0.4399479 0.5977873 0.5954067 0.5791050
 [540] 0.5943469 0.6162967 0.6287810 0.6721749 0.6555117 0.6885530 0.6841647
 [547] 0.6405791 0.5803989 0.5184382 0.4709133 0.4483384 0.3883663 0.4764821
 [554] 0.2625464 0.2013543 0.1865769 0.2094994 0.2345037 0.3439261 0.4370266
 [561] 0.5949312 0.5925453 0.5762103 0.5914831 0.6134871 0.6260073 0.6695551
 [568] 0.6528275 0.6860028 0.6815953 0.6378428 0.5775066 0.5154754 0.4679581
 [575] 0.4454057 0.3855516 0.4887618 0.2721791 0.2093794 0.1941562 0.2177606
 [582] 0.2434472 0.3551068 0.4491619 0.6067258 0.6043630 0.5881726 0.6033110
 [589] 0.6250818 0.6374484 0.6803442 0.6638886 0.6964984 0.6921720 0.6491247
 [596] 0.5894583 0.5277470 0.4802196 0.4575845 0.3972662 0.5024501 0.2831613
 [603] 0.2185887 0.2028678 0.2272326 0.2536742 0.3677445 0.4627449 0.6197130
 [610] 0.6173791 0.6013700 0.6163398 0.6378247 0.6500063 0.6921339 0.6759962
 [617] 0.7079481 0.7037155 0.6614930 0.6026424 0.5413709 0.4938997 0.4712044
 [624] 0.4104492 0.4475078 0.2406024 0.1832539 0.1695229 0.1908418 0.2142227
 [631] 0.3181143 0.4085790 0.5665489 0.5641182 0.5475139 0.5630366 0.5854990
 [638] 0.5983323 0.6432662 0.6259513 0.6603587 0.6557718 0.6104987 0.5488292
 [645] 0.4863326 0.4390673 0.4168165 0.3583220 0.4254055 0.2245655 0.1701829
 [652] 0.1572427 0.1773470 0.1994822 0.2989449 0.3870525 0.5443601 0.5419056
 [659] 0.5251674 0.5408137 0.5635330 0.5765545 0.6223871 0.6046815 0.6399200
 [666] 0.6352096 0.5889273 0.5264914 0.4639230 0.4170673 0.3951459 0.3379304
 [673] 0.4813290 0.2663241 0.2044957 0.1895425 0.2127341 0.2380082 0.3483217
 [680] 0.4418108 0.5996030 0.5972259 0.5809459 0.5961676 0.6180822 0.6305432
 [687] 0.6738380 0.6572162 0.6901712 0.6857954 0.6423172 0.5822381 0.5203247
 [694] 0.4727965 0.4502083 0.3901628 0.4935835 0.2760177 0.2125910 0.1971925
 [701] 0.2210648 0.2470181 0.3595372 0.4539397 0.6113196 0.6089667 0.5928377
 [708] 0.6079190 0.6295921 0.6418951 0.6845252 0.6681798 0.7005611 0.6962674
 [715] 0.6535061 0.5941189 0.5325526 0.4850369 0.4623767 0.4018947 0.4876283
 [722] 0.2712813 0.2086293 0.1934474 0.2169888 0.2426126 0.3540686 0.4480396
 [729] 0.6056427 0.6032777 0.5870732 0.6022247 0.6240179 0.6363992 0.6793567
 [736] 0.6628755 0.6955385 0.6912045 0.6480907 0.5883600 0.5266161 0.4790873
 [743] 0.4564587 0.3961803 0.5072575 0.2870812 0.2218913 0.2059955 0.2306273
 [750] 0.2573324 0.3722272 0.4675293 0.6242347 0.6219116 0.6059711 0.6208770
 [757] 0.6422554 0.6543687 0.6962166 0.6801940 0.7119084 0.7077095 0.6657858
 [764] 0.6072384 0.5461419 0.4987073 0.4759988 0.4151108 0.5492618 0.3227973
 [771] 0.2523682 0.2349483 0.2619001 0.2908574 0.4124086 0.5096466 0.6628942
 [778] 0.6606802 0.6454423 0.6596936 0.6800112 0.6914603 0.7306657 0.7157182
 [785] 0.7452292 0.7413395 0.7022098 0.6466567 0.5875269 0.5407807 0.5181366
 [792] 0.4565547 0.5169051 0.2950487 0.2286299 0.2123831 0.2375501 0.2647809
 [799] 0.3812940 0.4771531 0.6332480 0.6309477 0.6151524 0.6299231 0.6510780
 [806] 0.6630494 0.7043212 0.6885348 0.7197628 0.7156326 0.6743225 0.6164088
 [813] 0.5556951 0.5083601 0.4856379 0.4245158 0.4755842 0.2618500 0.2007760
 [820] 0.1860312 0.2089039 0.2338581 0.3431142 0.4361410 0.5940634 0.5916758
 [827] 0.5753309 0.5906129 0.6126331 0.6251641 0.6687581 0.6520111 0.6852269
 [834] 0.6808135 0.6370108 0.5766279 0.5145762 0.4670619 0.4445166 0.3846991
 [841] 0.4946037 0.2768340 0.2132750 0.1978395 0.2217684 0.2477780 0.3604776
 [848] 0.4549516 0.6122889 0.6099381 0.5938225 0.6088914 0.6305434 0.6428328
 [855] 0.6854059 0.6690842 0.7014166 0.6971298 0.6544297 0.5951027 0.5335685
 [862] 0.4860564 0.4633915 0.4028762 0.5116437 0.2906867 0.2249365 0.2088810
 [869] 0.2337563 0.2607009 0.3763376 0.4719011 0.6283426 0.6260297 0.6101540
 [876] 0.6249996 0.6462779 0.6583275 0.6999159 0.6839999 0.7154946 0.7113268
 [883] 0.6696799 0.6114164 0.5504887 0.5030951 0.4803783 0.4193784 0.5008142
 [890] 0.2818350 0.2174731 0.2018116 0.2260856 0.2524373 0.3662244 0.4611185
 [897] 0.6181697 0.6158322 0.5998003 0.6147913 0.6363117 0.6485162 0.6907379
 [904] 0.6745614 0.7065933 0.7023493 0.6600262 0.6010744 0.5397457 0.4922642
 [911] 0.4695742 0.4088668 0.5186644 0.2965164 0.2298749 0.2135641 0.2388287
 [918] 0.2661549 0.3829576 0.4789112 0.6348829 0.6325869 0.6168191 0.6315642
 [925] 0.6526770 0.6646217 0.7057864 0.6900438 0.7211818 0.7170643 0.6758679
 [932] 0.6180735 0.5574340 0.5101210 0.4873981 0.4262380 0.5371228 0.3121967
 [939] 0.2432496 0.2262686 0.2525535 0.2808706 0.4006060 0.4974169 0.6518758
 [946] 0.6496277 0.6341683 0.6486261 0.6692732 0.6809262 0.7209300 0.7056598
 [953] 0.7358295 0.7318479 0.6918792 0.6353995 0.5756221 0.5286093 0.5059133
 [960] 0.4444443 0.4956562 0.2776777 0.2139823 0.1985085 0.2224959 0.2485636
 [967] 0.3614488 0.4559958 0.6132880 0.6109394 0.5948376 0.6098936 0.6315237
 [974] 0.6437989 0.6863131 0.6700157 0.7022976 0.6980181 0.6553813 0.5961168
 [981] 0.5346162 0.4871083 0.4644386 0.4038895 0.4606527 0.2504244 0.1913247
 [988] 0.1771201 0.1991652 0.2232845 0.3297267 0.4214526 0.5795227 0.5771105
 [995] 0.5606156 0.5760369 0.5983078 0.6110080 0.6553407 0.6382822
 [ reached getOption("max.print") -- omitted 671749 entries ]
> pred.model_glm.prob
             no       yes
57649 0.5201571 0.4798429
57650 0.7348375 0.2651625
57651 0.7964710 0.2035290
57652 0.8113703 0.1886297
57653 0.7882613 0.2117387
57654 0.7630698 0.2369302
57655 0.6530284 0.3469716
57656 0.5596569 0.4403431
57657 0.4018271 0.5981729
57658 0.4042070 0.5957930
57659 0.4205041 0.5794959
57660 0.4052665 0.5947335
57661 0.3833241 0.6166759
57662 0.3708447 0.6291553
57663 0.3274718 0.6725282
57664 0.3441262 0.6558738
57665 0.3111032 0.6888968
57666 0.3154889 0.6845111
57667 0.3590517 0.6409483
57668 0.4192106 0.5807894
57669 0.4811614 0.5188386
57670 0.5286871 0.4713129
57671 0.5512649 0.4487351
57672 0.6112527 0.3887473
57673 0.5147886 0.4852114
57674 0.7306270 0.2693730
57675 0.7929634 0.2070366
57676 0.8080576 0.1919424
57677 0.7846505 0.2153495
57678 0.7591607 0.2408393
57679 0.6481409 0.3518591
57680 0.5543516 0.4456484
57681 0.3966703 0.6033297
57682 0.3990400 0.6009600
57683 0.4152740 0.5847260
57684 0.4000950 0.5999050
57685 0.3782546 0.6217454
57686 0.3658423 0.6341577
57687 0.3227543 0.6772457
57688 0.3392899 0.6607101
57689 0.3065141 0.6934859
57690 0.3108642 0.6891358
57691 0.3541189 0.6458811
57692 0.4139851 0.5860149
57693 0.4757962 0.5242038
57694 0.5233266 0.4766734
57695 0.5459406 0.4540594
57696 0.6061316 0.3938684
57697 0.5115498 0.4884502
57698 0.7280679 0.2719321
57699 0.7908270 0.2091730
57700 0.8060389 0.1939611
57701 0.7824518 0.2175482
57702 0.7567824 0.2432176
57703 0.6451787 0.3548213
57704 0.5511467 0.4488533
57705 0.3935719 0.6064281
57706 0.3959352 0.6040648
57707 0.4121296 0.5878704
57708 0.3969875 0.6030125
57709 0.3752106 0.6247894
57710 0.3628399 0.6371601
57711 0.3199271 0.6800729
57712 0.3363898 0.6636102
57713 0.3037653 0.6962347
57714 0.3080938 0.6919062
57715 0.3511594 0.6488406
57716 0.4108435 0.5891565
57717 0.4725639 0.5274361
57718 0.5200917 0.4799083
57719 0.5427250 0.4572750
57720 0.6030324 0.3969676
57721 0.4939259 0.5060741
57722 0.7138868 0.2861132
57723 0.7789250 0.2210750
57724 0.7947778 0.2052222
57725 0.7702117 0.2297883
57726 0.7435714 0.2564286
57727 0.6288784 0.3711216
57728 0.5336490 0.4663510
57729 0.3768764 0.6231236
57730 0.3792022 0.6207978
57731 0.3951598 0.6048402
57732 0.3802380 0.6197620
57733 0.3588331 0.6411669
57734 0.3467028 0.6532972
57735 0.3047855 0.6952145
57736 0.3208367 0.6791633
57737 0.2890636 0.7109364
57738 0.2932708 0.7067292
57739 0.3352684 0.6647316
57740 0.3938913 0.6061087
57741 0.4550318 0.5449682
57742 0.5024762 0.4975238
57743 0.5251819 0.4748181
57744 0.5860382 0.4139618
57745 0.4856067 0.5143933
57746 0.7070388 0.2929612
57747 0.7731390 0.2268610
57748 0.7892944 0.2107056
57749 0.7642666 0.2357334
57750 0.7371723 0.2628277
57751 0.6210757 0.3789243
57752 0.5253553 0.4746447
57753 0.3690909 0.6309091
57754 0.3713972 0.6286028
57755 0.3872313 0.6127687
57756 0.3724245 0.6275755
57757 0.3512102 0.6487898
57758 0.3392012 0.6607988
57759 0.2977776 0.7022224
57760 0.3136261 0.6863739
57761 0.2822703 0.7177297
57762 0.2864185 0.7135815
57763 0.3278901 0.6721099
57764 0.3859720 0.6140280
57765 0.4467894 0.5532106
57766 0.4941537 0.5058463
57767 0.5168740 0.4831260
57768 0.5779394 0.4220606
57769 0.5181054 0.4818946
57770 0.7332329 0.2667671
57771 0.7951354 0.2048646
57772 0.8101092 0.1898908
57773 0.7868863 0.2131137
57774 0.7615807 0.2384193
57775 0.6511638 0.3488362
57776 0.5576304 0.4423696
57777 0.3998532 0.6001468
57778 0.4022293 0.5977707
57779 0.4185027 0.5814973
57780 0.4032871 0.5967129
57781 0.3813832 0.6186168
57782 0.3689292 0.6310708
57783 0.3256643 0.6743357
57784 0.3422736 0.6577264
57785 0.3093445 0.6906555
57786 0.3137167 0.6862833
57787 0.3571625 0.6428375
57788 0.4172109 0.5827891
57789 0.4791099 0.5208901
57790 0.5266387 0.4733613
57791 0.5492309 0.4507691
57792 0.6092980 0.3907020
57793 0.5591814 0.4408186
57794 0.7643134 0.2356866
57795 0.8207667 0.1792333
57796 0.8342576 0.1657424
57797 0.8133073 0.1866927
57798 0.7903029 0.2096971
57799 0.6877339 0.3122661
57800 0.5979518 0.4020482
57801 0.4401165 0.5598835
57802 0.4425553 0.5574447
57803 0.4592069 0.5407931
57804 0.4436405 0.5563595
57805 0.4210915 0.5789085
57806 0.4081964 0.5918036
57807 0.3629753 0.6370247
57808 0.3804140 0.6195860
57809 0.3457444 0.6542556
57810 0.3503700 0.6496300
57811 0.3959632 0.6040368
57812 0.4578884 0.5421116
57813 0.5204332 0.4795668
57814 0.5675944 0.4324056
57815 0.5897546 0.4102454
57816 0.6478836 0.3521164
57817 0.5170338 0.4829662
57818 0.7323927 0.2676073
57819 0.7944355 0.2055645
57820 0.8094482 0.1905518
57821 0.7861657 0.2138343
57822 0.7608006 0.2391994
57823 0.6501884 0.3498116
57824 0.5565715 0.4434285
57825 0.3988238 0.6011762
57826 0.4011978 0.5988022
57827 0.4174587 0.5825413
57828 0.4022548 0.5977452
57829 0.3803712 0.6196288
57830 0.3679306 0.6320694
57831 0.3247225 0.6752775
57832 0.3413081 0.6586919
57833 0.3084284 0.6915716
57834 0.3127934 0.6872066
57835 0.3561778 0.6438222
57836 0.4161678 0.5838322
57837 0.4780390 0.5219610
57838 0.5255688 0.4744312
57839 0.5481682 0.4518318
57840 0.6082759 0.3917241
57841 0.4999981 0.5000019
57842 0.7188222 0.2811778
57843 0.7830794 0.2169206
57844 0.7987112 0.2012888
57845 0.7744824 0.2255176
57846 0.7481753 0.2518247
57847 0.6345295 0.3654705
57848 0.5396888 0.4603112
57849 0.3825975 0.6174025
57850 0.3849368 0.6150632
57851 0.4009799 0.5990201
57852 0.3859785 0.6140215
57853 0.3644405 0.6355595
57854 0.3522247 0.6477753
57855 0.3099567 0.6900433
57856 0.3261523 0.6738477
57857 0.2940808 0.7059192
57858 0.2983304 0.7016696
57859 0.3407032 0.6592968
57860 0.3997050 0.6002950
57861 0.4610615 0.5389385
57862 0.5085479 0.4914521
57863 0.5312350 0.4687650
57864 0.5919183 0.4080817
57865 0.5108280 0.4891720
57866 0.7274956 0.2725044
57867 0.7903488 0.2096512
57868 0.8055869 0.1944131
57869 0.7819597 0.2180403
57870 0.7562503 0.2437497
57871 0.6445172 0.3554828
57872 0.5504320 0.4495680
57873 0.3928826 0.6071174
57874 0.3952445 0.6047555
57875 0.4114299 0.5885701
57876 0.3962962 0.6037038
57877 0.3745336 0.6254664
57878 0.3621723 0.6378277
57879 0.3192989 0.6807011
57880 0.3357452 0.6642548
57881 0.3031547 0.6968453
57882 0.3074784 0.6925216
57883 0.3505015 0.6494985
57884 0.4101445 0.5898555
57885 0.4718439 0.5281561
57886 0.5193707 0.4806293
57887 0.5420081 0.4579919
57888 0.6023407 0.3976593
57889 0.4929713 0.5070287
57890 0.7131061 0.2868939
57891 0.7782666 0.2217334
57892 0.7941541 0.2058459
57893 0.7695350 0.2304650
57894 0.7428425 0.2571575
57895 0.6279866 0.3720134
57896 0.5326985 0.4673015
57897 0.3759800 0.6240200
57898 0.3783035 0.6216965
57899 0.3942474 0.6057526
57900 0.3793384 0.6206616
57901 0.3579549 0.6420451
57902 0.3458383 0.6541617
57903 0.3039769 0.6960231
57904 0.3200050 0.6799950
57905 0.2882794 0.7117206
57906 0.2924799 0.7075201
57907 0.3344178 0.6655822
57908 0.3929799 0.6070201
57909 0.4540850 0.5459150
57910 0.5015215 0.4984785
57911 0.5242294 0.4757706
57912 0.5851114 0.4148886
57913 0.4744749 0.5255251
57914 0.6977160 0.3022840
57915 0.7652211 0.2347789
57916 0.7817813 0.2182187
57917 0.7561368 0.2438632
57918 0.7284401 0.2715599
57919 0.6105242 0.3894758
57920 0.5142232 0.4857768
57921 0.3587671 0.6412329
57922 0.3610459 0.6389541
57923 0.3767031 0.6232969
57924 0.3620610 0.6379390
57925 0.3411162 0.6588838
57926 0.3292772 0.6707228
57927 0.2885363 0.7114637
57928 0.3041060 0.6958940
57929 0.2733229 0.7266771
57930 0.2773905 0.7226095
57931 0.3181377 0.6818623
57932 0.3754570 0.6245430
57933 0.4357935 0.5642065
57934 0.4830099 0.5169901
57935 0.5057300 0.4942700
57936 0.5670241 0.4329759
57937 0.5159824 0.4840176
57938 0.7315667 0.2684333
57939 0.7937471 0.2062529
57940 0.8087979 0.1912021
57941 0.7854570 0.2145430
57942 0.7600335 0.2399665
57943 0.6492302 0.3507698
57944 0.5555322 0.4444678
57945 0.3978148 0.6021852
57946 0.4001868 0.5998132
57947 0.4164351 0.5835649
57948 0.4012428 0.5987572
57949 0.3793793 0.6206207
57950 0.3669520 0.6330480
57951 0.3238000 0.6762000
57952 0.3403622 0.6596378
57953 0.3075310 0.6924690
57954 0.3118891 0.6881109
57955 0.3552129 0.6447871
57956 0.4151452 0.5848548
57957 0.4769885 0.5230115
57958 0.5245188 0.4754812
57959 0.5471252 0.4528748
57960 0.6072722 0.3927278
57961 0.5508959 0.4491041
57962 0.7582164 0.2417836
57963 0.8157781 0.1842219
57964 0.8295665 0.1704335
57965 0.8081596 0.1918404
57966 0.7846889 0.2153111
57967 0.6804840 0.3195160
57968 0.5898605 0.4101395
57969 0.4318668 0.5681332
57970 0.4342954 0.5657046
57971 0.4508876 0.5491124
57972 0.4353761 0.5646239
57973 0.4129354 0.5870646
57974 0.4001175 0.5998825
57975 0.3552541 0.6447459
57976 0.3725388 0.6274612
57977 0.3381952 0.6618048
57978 0.3427727 0.6572273
57979 0.3879677 0.6120323
57980 0.4495731 0.5504269
57981 0.5120549 0.4879451
57982 0.5593424 0.4406576
57983 0.5816138 0.4183862
57984 0.6401926 0.3598074
57985 0.5070440 0.4929560
57986 0.7244837 0.2755163
57987 0.7878289 0.2121711
57988 0.8032046 0.1967954
57989 0.7793672 0.2206328
57990 0.7534485 0.2465515
57991 0.6410406 0.3589594
57992 0.5466825 0.4533175
57993 0.3892771 0.6107229
57994 0.3916313 0.6083687
57995 0.4077684 0.5922316
57996 0.3926795 0.6073205
57997 0.3709936 0.6290064
57998 0.3586821 0.6413179
57999 0.3160172 0.6839828
58000 0.3323770 0.6676230
58001 0.2999658 0.7000342
58002 0.3042638 0.6957362
58003 0.3470625 0.6529375
58004 0.4064866 0.5935134
58005 0.4680724 0.5319276
58006 0.5155901 0.4844099
58007 0.5382472 0.4617528
58008 0.5987085 0.4012915
58009 0.5031934 0.4968066
58010 0.7213983 0.2786017
58011 0.7852427 0.2147573
58012 0.8007583 0.1992417
58013 0.7767070 0.2232930
58014 0.7505758 0.2494242
58015 0.6374884 0.3625116
58016 0.5428624 0.4571376
58017 0.3856212 0.6143788
58018 0.3879673 0.6120327
58019 0.4040538 0.5959462
58020 0.3890121 0.6109879
58021 0.3674061 0.6325939
58022 0.3551465 0.6448535
58023 0.3126970 0.6873030
58024 0.3289676 0.6710324
58025 0.2967411 0.7032589
58026 0.3010128 0.6989872
58027 0.3435801 0.6564199
58028 0.4027757 0.5972243
58029 0.4642391 0.5357609
58030 0.5117420 0.4882580
58031 0.5344166 0.4655834
58032 0.5950020 0.4049980
58033 0.4933720 0.5066280
58034 0.7134340 0.2865660
58035 0.7785431 0.2214569
58036 0.7944161 0.2055839
58037 0.7698192 0.2301808
58038 0.7431486 0.2568514
58039 0.6283611 0.3716389
58040 0.5330975 0.4669025
58041 0.3763562 0.6236438
58042 0.3786807 0.6213193
58043 0.3946303 0.6053697
58044 0.3797159 0.6202841
58045 0.3583234 0.6416766
58046 0.3462010 0.6537990
58047 0.3043162 0.6956838
58048 0.3203540 0.6796460
58049 0.2886084 0.7113916
58050 0.2928117 0.7071883
58051 0.3347747 0.6652253
58052 0.3933624 0.6066376
58053 0.4544824 0.5455176
58054 0.5019223 0.4980777
58055 0.5246293 0.4753707
58056 0.5855005 0.4144995
58057 0.4859069 0.5140931
58058 0.7072877 0.2927123
58059 0.7733497 0.2266503
58060 0.7894942 0.2105058
58061 0.7644831 0.2355169
58062 0.7374051 0.2625949
58063 0.6213585 0.3786415
58064 0.5256550 0.4743450
58065 0.3693708 0.6306292
58066 0.3716778 0.6283222
58067 0.3875165 0.6124835
58068 0.3727054 0.6272946
58069 0.3514841 0.6485159
58070 0.3394707 0.6605293
58071 0.2980289 0.7019711
58072 0.3138849 0.6861151
58073 0.2825139 0.7174861
58074 0.2866642 0.7133358
58075 0.3281550 0.6718450
58076 0.3862568 0.6137432
58077 0.4470865 0.5529135
58078 0.4944541 0.5055459
58079 0.5171740 0.4828260
58080 0.5782325 0.4217675
58081 0.4592951 0.5407049
58082 0.6846994 0.3153006
58083 0.7540869 0.2459131
58084 0.7711976 0.2288024
58085 0.7447155 0.2552845
58086 0.7162084 0.2837916
58087 0.5959276 0.4040724
58088 0.4989792 0.5010208
58089 0.3448599 0.6551401
58090 0.3470982 0.6529018
58091 0.3624937 0.6375063
58092 0.3480955 0.6519045
58093 0.3275437 0.6724563
58094 0.3159499 0.6840501
58095 0.2761790 0.7238210
58096 0.2913549 0.7086451
58097 0.2613778 0.7386222
58098 0.2653325 0.7346675
58099 0.3050562 0.6949438
58100 0.3612674 0.6387326
58101 0.4208602 0.5791398
58102 0.4678001 0.5321999
58103 0.4904836 0.5095164
58104 0.5519934 0.4480066
58105 0.5057557 0.4942443
58106 0.7234537 0.2765463
58107 0.7869662 0.2130338
58108 0.8023886 0.1976114
58109 0.7784797 0.2215203
58110 0.7524899 0.2475101
58111 0.6398538 0.3601462
58112 0.5454049 0.4545951
58113 0.3880525 0.6119475
58114 0.3904040 0.6095960
58115 0.4065244 0.5934756
58116 0.3914511 0.6085489
58117 0.3697916 0.6302084
58118 0.3574974 0.6425026
58119 0.3149042 0.6850958
58120 0.3312343 0.6687657
58121 0.2988846 0.7011154
58122 0.3031738 0.6968262
58123 0.3458955 0.6541045
58124 0.4052438 0.5947562
58125 0.4667894 0.5332106
58126 0.5143028 0.4856972
58127 0.5369660 0.4630340
58128 0.5974696 0.4025304
58129 0.5476920 0.4523080
58130 0.7558360 0.2441640
58131 0.8138252 0.1861748
58132 0.8277289 0.1722711
58133 0.8061451 0.1938549
58134 0.7824943 0.2175057
58135 0.6776636 0.3223364
58136 0.5867260 0.4132740
58137 0.4286943 0.5713057
58138 0.4311186 0.5688814
58139 0.4476855 0.5523145
58140 0.4321975 0.5678025
58141 0.4098017 0.5901983
58142 0.3970153 0.6029847
58143 0.3522954 0.6477046
58144 0.3695187 0.6304813
58145 0.3353047 0.6646953
58146 0.3398632 0.6601368
58147 0.3848992 0.6151008
58148 0.4463728 0.5536272
 [ reached 'max' / getOption("max.print") -- omitted 672249 rows ]
> roc.model_glm = pROC:roc(
+   testData$did_crash_happen,
+   as.vector(ifelse(pred.model_glm.prob[,"yes"] > 0.5, 1, 0))
+ )
Error: object 'pROC' not found
> library(pROC)
> roc.model_glm = pROC:roc(
+   testData$did_crash_happen,
+   as.vector(ifelse(pred.model_glm.prob[,"yes"] > 0.5, 1, 0))
+ )
Error: object 'pROC' not found
> roc.model_glm = pROC:roc(
+   testData$did_crash_happen,
+   as.vector(ifelse(pred.model_glm.prob[,"yes"] > 0.5, 1, 0))
+ )
Error: object 'pROC' not found
> library(pROC)
> roc.model_glm = pROC:roc(
+   testData$did_crash_happen,
+   as.vector(ifelse(pred.model_glm.prob[,"yes"] > 0.5, 1, 0))
+ )
Error: object 'pROC' not found
> roc.model_glm = pROC::roc(
+   testData$did_crash_happen,
+   as.vector(ifelse(pred.model_glm.prob[,"yes"] > 0.5, 1, 0))
+ )
Setting levels: control = no, case = yes
Setting direction: controls < cases
> auc.model_gbm = pROC::auc(roc.model_glm)
> auc.model_glm = pROC::auc(roc.model_glm)
> print(auc.modeL_glm)
Error in print(auc.modeL_glm) : object 'auc.modeL_glm' not found
> print(auc.model_glm)
Area under the curve: 0.6598
> #plot ROC curve
> plot.roc(roc.model_glm, print.auc = TRUE, col = 'red', print.thres = "best")
> #generate confusion matrix, as well as other metrics such as accuracy, balanced accuracy
> confusionMatri(data = pred.model_glm.raw, testData$did_crash_happen)
Error in confusionMatri(data = pred.model_glm.raw, testData$did_crash_happen) : 
  could not find function "confusionMatri"
> #generate confusion matrix, as well as other metrics such as accuracy, balanced accuracy
> confusionMatrix(data = pred.model_glm.raw, testData$did_crash_happen)
Error: package e1071 is required
> install.packages("e1071")
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Installing package into ‘C:/Users/Alex Fung/Documents/R/win-library/3.6’
(as ‘lib’ is unspecified)
trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.6/e1071_1.7-3.zip'
Content type 'application/zip' length 1023015 bytes (999 KB)
downloaded 999 KB

package ‘e1071’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
	C:\Users\Alex Fung\AppData\Local\Temp\Rtmpcf8CgA\downloaded_packages
> library(e1071)
> #generate confusion matrix, as well as other metrics such as accuracy, balanced accuracy
> confusionMatrix(data = pred.model_glm.raw, testData$did_crash_happen)
Confusion Matrix and Statistics

          Reference
Prediction     no    yes
       no  314273  43937
       yes 204801 109738
                                          
               Accuracy : 0.6303          
                 95% CI : (0.6291, 0.6314)
    No Information Rate : 0.7716          
    P-Value [Acc > NIR] : 1               
                                          
                  Kappa : 0.2335          
                                          
 Mcnemar's Test P-Value : <2e-16          
                                          
            Sensitivity : 0.6054          
            Specificity : 0.7141          
         Pos Pred Value : 0.8773          
         Neg Pred Value : 0.3489          
             Prevalence : 0.7716          
         Detection Rate : 0.4671          
   Detection Prevalence : 0.5325          
      Balanced Accuracy : 0.6598          
                                          
       'Positive' Class : no              
                                          
> #summary of model
> summary(model_glm)

Call:
NULL

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1122  -1.0600   0.1391   0.9990   2.7988  

Coefficients:
              Estimate Std. Error  z value Pr(>|z|)    
(Intercept)  9.671e+09  1.937e+10    0.499 0.617597    
precinct5   -3.675e-01  3.185e-02  -11.538  < 2e-16 ***
precinct6   -8.296e-01  3.337e-02  -24.858  < 2e-16 ***
precinct7   -9.708e-01  3.418e-02  -28.406  < 2e-16 ***
precinct9   -1.012e+00  3.416e-02  -29.620  < 2e-16 ***
precinct10  -1.953e-01  3.153e-02   -6.194 5.88e-10 ***
precinct13  -2.506e-01  3.163e-02   -7.922 2.34e-15 ***
precinct14   1.148e-01  3.112e-02    3.688 0.000226 ***
precinct17  -3.366e-02  3.126e-02   -1.077 0.281495    
precinct18   1.631e-01  3.108e-02    5.248 1.54e-07 ***
precinct19   3.231e-01  3.081e-02   10.487  < 2e-16 ***
precinct20  -6.842e-01  3.277e-02  -20.881  < 2e-16 ***
precinct22  -2.286e+00  4.497e-02  -50.834  < 2e-16 ***
precinct23  -8.810e-01  3.343e-02  -26.357  < 2e-16 ***
precinct24  -1.103e+00  3.429e-02  -32.154  < 2e-16 ***
precinct25  -3.644e-01  3.175e-02  -11.479  < 2e-16 ***
precinct26  -1.343e+00  3.602e-02  -37.297  < 2e-16 ***
precinct28  -1.354e+00  3.591e-02  -37.709  < 2e-16 ***
precinct30  -1.369e+00  3.609e-02  -37.945  < 2e-16 ***
precinct32  -9.256e-01  3.377e-02  -27.405  < 2e-16 ***
precinct33  -8.943e-01  3.353e-02  -26.674  < 2e-16 ***
precinct34  -5.868e-01  3.252e-02  -18.045  < 2e-16 ***
precinct40   1.214e-01  3.105e-02    3.910 9.25e-05 ***
precinct41  -5.982e-01  3.241e-02  -18.459  < 2e-16 ***
precinct42  -6.665e-01  3.256e-02  -20.474  < 2e-16 ***
precinct43   2.047e-01  3.109e-02    6.585 4.56e-11 ***
precinct44   5.425e-02  3.108e-02    1.746 0.080896 .  
precinct45  -5.717e-02  3.112e-02   -1.837 0.066173 .  
precinct46  -1.648e-01  3.143e-02   -5.243 1.58e-07 ***
precinct47   2.970e-01  3.100e-02    9.582  < 2e-16 ***
precinct48  -4.049e-01  3.177e-02  -12.745  < 2e-16 ***
precinct49  -3.333e-01  3.160e-02  -10.546  < 2e-16 ***
precinct50  -5.275e-01  3.202e-02  -16.472  < 2e-16 ***
precinct52  -5.415e-02  3.123e-02   -1.734 0.082923 .  
precinct60  -4.968e-01  3.207e-02  -15.491  < 2e-16 ***
precinct61  -1.224e-02  3.104e-02   -0.394 0.693322    
precinct62  -8.368e-02  3.121e-02   -2.681 0.007336 ** 
precinct63  -1.368e-01  3.134e-02   -4.366 1.26e-05 ***
precinct66  -9.283e-02  3.122e-02   -2.973 0.002949 ** 
precinct67   1.933e-01  3.087e-02    6.262 3.80e-10 ***
precinct68  -1.273e-01  3.119e-02   -4.081 4.49e-05 ***
precinct69  -4.475e-01  3.203e-02  -13.973  < 2e-16 ***
precinct70   3.028e-03  3.109e-02    0.097 0.922416    
precinct71  -3.426e-01  3.179e-02  -10.778  < 2e-16 ***
precinct72   9.587e-02  3.108e-02    3.084 0.002040 ** 
precinct73  -2.811e-01  3.152e-02   -8.916  < 2e-16 ***
precinct75   8.517e-01  3.123e-02   27.268  < 2e-16 ***
precinct76  -6.650e-01  3.268e-02  -20.351  < 2e-16 ***
precinct77  -5.728e-01  3.226e-02  -17.752  < 2e-16 ***
precinct78  -4.226e-01  3.181e-02  -13.285  < 2e-16 ***
precinct79  -3.289e-01  3.176e-02  -10.358  < 2e-16 ***
precinct81  -8.163e-01  3.311e-02  -24.659  < 2e-16 ***
precinct83  -3.245e-01  3.171e-02  -10.231  < 2e-16 ***
precinct84  -2.169e-01  3.138e-02   -6.911 4.80e-12 ***
precinct88  -9.364e-01  3.374e-02  -27.752  < 2e-16 ***
precinct90   1.510e-01  3.105e-02    4.861 1.17e-06 ***
precinct94  -3.187e-01  3.177e-02  -10.031  < 2e-16 ***
precinct100 -1.621e+00  3.808e-02  -42.558  < 2e-16 ***
precinct101 -1.248e+00  3.528e-02  -35.368  < 2e-16 ***
precinct102  2.178e-01  3.086e-02    7.059 1.68e-12 ***
precinct103  3.644e-02  3.113e-02    1.171 0.241697    
precinct104  2.871e-01  3.092e-02    9.285  < 2e-16 ***
precinct105  8.892e-01  3.121e-02   28.494  < 2e-16 ***
precinct106  4.105e-01  3.107e-02   13.212  < 2e-16 ***
precinct107  2.808e-01  3.087e-02    9.095  < 2e-16 ***
precinct108  5.484e-01  3.103e-02   17.674  < 2e-16 ***
precinct109  8.268e-01  3.112e-02   26.571  < 2e-16 ***
precinct110  2.066e-01  3.092e-02    6.681 2.37e-11 ***
precinct111  1.455e-01  3.096e-02    4.699 2.61e-06 ***
precinct112 -2.155e-01  3.139e-02   -6.866 6.59e-12 ***
precinct113  3.937e-01  3.097e-02   12.713  < 2e-16 ***
precinct114  5.175e-01  3.095e-02   16.718  < 2e-16 ***
precinct115  1.113e-01  3.108e-02    3.580 0.000343 ***
precinct120 -1.877e-01  3.135e-02   -5.988 2.13e-09 ***
precinct121  1.109e-01  3.105e-02    3.570 0.000357 ***
precinct122  1.269e-02  3.130e-02    0.406 0.685096    
precinct123 -6.138e-01  3.241e-02  -18.942  < 2e-16 ***
month.L      1.900e-01  9.649e-02    1.969 0.048977 *  
month.Q     -5.946e-02  9.842e-02   -0.604 0.545797    
month.C     -3.225e-02  5.812e-02   -0.555 0.579020    
`month^4`   -1.727e-02  5.464e-02   -0.316 0.751904    
`month^5`    1.010e-03  4.479e-02    0.023 0.982009    
`month^6`    1.257e-02  3.580e-02    0.351 0.725451    
`month^7`    4.362e-03  3.447e-02    0.127 0.899304    
`month^8`    9.275e-02  3.243e-02    2.860 0.004231 ** 
`month^9`   -2.218e-02  3.409e-02   -0.651 0.515243    
`month^10`   3.104e-02  2.974e-02    1.044 0.296570    
`month^11`   4.815e-02  2.509e-02    1.919 0.054994 .  
week.L       1.197e+11  2.397e+11    0.499 0.617597    
week.Q       1.488e+11  2.980e+11    0.499 0.617597    
week.C       1.663e+11  3.332e+11    0.499 0.617597    
`week^4`     1.749e+11  3.503e+11    0.499 0.617597    
`week^5`     1.759e+11  3.523e+11    0.499 0.617597    
`week^6`     1.706e+11  3.418e+11    0.499 0.617597    
`week^7`     1.605e+11  3.215e+11    0.499 0.617597    
`week^8`     1.468e+11  2.939e+11    0.499 0.617597    
`week^9`     1.307e+11  2.618e+11    0.499 0.617597    
`week^10`    1.135e+11  2.274e+11    0.499 0.617597    
`week^11`    9.624e+10  1.928e+11    0.499 0.617597    
`week^12`    7.969e+10  1.596e+11    0.499 0.617597    
`week^13`    6.447e+10  1.291e+11    0.499 0.617597    
`week^14`    5.098e+10  1.021e+11    0.499 0.617597    
`week^15`    3.940e+10  7.892e+10    0.499 0.617597    
`week^16`    2.977e+10  5.962e+10    0.499 0.617597    
`week^17`    2.198e+10  4.404e+10    0.499 0.617597    
`week^18`    1.587e+10  3.179e+10    0.499 0.617597    
`week^19`    1.120e+10  2.243e+10    0.499 0.617597    
`week^20`    7.719e+09  1.546e+10    0.499 0.617597    
`week^21`    5.198e+09  1.041e+10    0.499 0.617597    
`week^22`    3.419e+09  6.848e+09    0.499 0.617597    
`week^23`    2.195e+09  4.397e+09    0.499 0.617597    
`week^24`    1.376e+09  2.755e+09    0.499 0.617597    
`week^25`    8.494e+08  1.701e+09    0.499 0.617597    
`week^26`    5.057e+08  1.013e+09    0.499 0.617597    
`week^27`    2.716e+08  5.439e+08    0.499 0.617597    
`week^28`    1.532e+08  3.069e+08    0.499 0.617597    
`week^29`    7.125e+07  1.427e+08    0.499 0.617597    
`week^30`    3.812e+07  7.634e+07    0.499 0.617597    
`week^31`    1.526e+07  3.057e+07    0.499 0.617597    
`week^32`    7.030e+06  1.408e+07    0.499 0.617597    
`week^33`   -1.606e+05  3.217e+05   -0.499 0.617597    
`week^34`   -7.148e+05  1.432e+06   -0.499 0.617597    
`week^35`    5.534e+05  1.109e+06    0.499 0.617597    
`week^36`   -1.158e+05  2.320e+05   -0.499 0.617596    
`week^37`    2.164e+05  4.335e+05    0.499 0.617597    
`week^38`   -3.794e+05  7.599e+05   -0.499 0.617597    
`week^39`    3.757e+05  7.526e+05    0.499 0.617597    
`week^40`    4.968e+05  9.952e+05    0.499 0.617597    
`week^41`   -3.979e+05  7.969e+05   -0.499 0.617597    
`week^42`    7.902e+05  1.583e+06    0.499 0.617597    
`week^43`   -1.540e+05  3.085e+05   -0.499 0.617597    
`week^44`    1.039e+06  2.081e+06    0.499 0.617597    
`week^45`    8.376e+05  1.678e+06    0.499 0.617597    
`week^46`   -8.712e+05  1.745e+06   -0.499 0.617597    
`week^47`   -2.966e+05  5.942e+05   -0.499 0.617597    
`week^48`    9.438e+04  1.890e+05    0.499 0.617597    
`week^49`    5.820e+04  1.166e+05    0.499 0.617597    
`week^50`   -1.217e+05  2.437e+05   -0.499 0.617597    
`week^51`    5.041e+05  1.010e+06    0.499 0.617597    
`week^52`    5.583e+05  1.118e+06    0.499 0.617597    
day.L       -1.956e-02  3.178e-02   -0.616 0.538128    
day.Q        1.870e-02  3.667e-02    0.510 0.609985    
day.C        3.633e-02  2.714e-02    1.338 0.180748    
`day^4`      5.699e-02  2.257e-02    2.525 0.011577 *  
`day^5`     -1.505e-02  1.959e-02   -0.768 0.442310    
`day^6`     -4.854e-02  1.786e-02   -2.717 0.006584 ** 
`day^7`      2.085e-02  1.650e-02    1.264 0.206208    
`day^8`      6.869e-03  1.588e-02    0.433 0.665264    
`day^9`      2.750e-02  1.543e-02    1.782 0.074786 .  
`day^10`    -1.534e-02  1.516e-02   -1.012 0.311310    
`day^11`    -3.606e-03  1.496e-02   -0.241 0.809566    
`day^12`    -2.204e-02  1.490e-02   -1.479 0.139166    
`day^13`    -8.180e-03  1.488e-02   -0.550 0.582483    
`day^14`     6.482e-03  1.486e-02    0.436 0.662586    
`day^15`     2.492e-02  1.484e-02    1.679 0.093120 .  
`day^16`     1.574e-02  1.479e-02    1.064 0.287386    
`day^17`    -3.826e-02  1.477e-02   -2.590 0.009594 ** 
`day^18`    -1.949e-03  1.475e-02   -0.132 0.894907    
`day^19`    -2.114e-02  1.472e-02   -1.436 0.150966    
`day^20`     1.942e-02  1.468e-02    1.323 0.185894    
`day^21`    -9.058e-03  1.466e-02   -0.618 0.536690    
`day^22`     5.800e-03  1.463e-02    0.396 0.691770    
`day^23`    -1.649e-02  1.461e-02   -1.128 0.259169    
`day^24`    -1.658e-03  1.461e-02   -0.113 0.909689    
`day^25`    -2.935e-03  1.458e-02   -0.201 0.840507    
`day^26`    -4.441e-02  1.454e-02   -3.054 0.002256 ** 
`day^27`    -1.246e-02  1.456e-02   -0.856 0.392227    
`day^28`     5.379e-03  1.458e-02    0.369 0.712138    
`day^29`    -2.085e-02  1.459e-02   -1.429 0.153115    
`day^30`     1.353e-02  1.457e-02    0.929 0.353075    
weekday.L   -8.760e-02  7.211e-03  -12.148  < 2e-16 ***
weekday.Q   -1.856e-01  7.220e-03  -25.713  < 2e-16 ***
weekday.C   -1.065e-01  7.074e-03  -15.050  < 2e-16 ***
`weekday^4`  8.877e-03  7.039e-03    1.261 0.207267    
`weekday^5`  6.982e-02  6.986e-03    9.994  < 2e-16 ***
`weekday^6`  2.263e-02  6.964e-03    3.250 0.001155 ** 
hour.L       1.984e+00  1.417e-02  140.006  < 2e-16 ***
hour.Q      -1.927e+00  1.322e-02 -145.697  < 2e-16 ***
hour.C      -1.490e+00  1.325e-02 -112.465  < 2e-16 ***
`hour^4`     1.206e+00  1.364e-02   88.459  < 2e-16 ***
`hour^5`    -7.179e-01  1.358e-02  -52.866  < 2e-16 ***
`hour^6`     4.538e-01  1.362e-02   33.325  < 2e-16 ***
`hour^7`     2.457e-01  1.368e-02   17.964  < 2e-16 ***
`hour^8`    -3.285e-01  1.370e-02  -23.986  < 2e-16 ***
`hour^9`    -2.393e-01  1.379e-02  -17.353  < 2e-16 ***
`hour^10`    1.951e-01  1.385e-02   14.080  < 2e-16 ***
`hour^11`   -8.258e-02  1.387e-02   -5.953 2.63e-09 ***
`hour^12`   -9.731e-02  1.389e-02   -7.007 2.44e-12 ***
`hour^13`    1.534e-01  1.397e-02   10.983  < 2e-16 ***
`hour^14`    1.409e-02  1.397e-02    1.009 0.312949    
`hour^15`   -1.372e-01  1.384e-02   -9.916  < 2e-16 ***
`hour^16`    2.112e-02  1.371e-02    1.540 0.123503    
`hour^17`    2.788e-02  1.359e-02    2.052 0.040141 *  
`hour^18`   -1.076e-03  1.335e-02   -0.081 0.935755    
`hour^19`   -1.410e-03  1.304e-02   -0.108 0.913853    
`hour^20`    1.255e-01  1.268e-02    9.897  < 2e-16 ***
`hour^21`   -1.542e-01  1.232e-02  -12.518  < 2e-16 ***
`hour^22`   -1.602e-02  1.209e-02   -1.324 0.185342    
`hour^23`    6.555e-02  1.205e-02    5.442 5.27e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 931859  on 672193  degrees of freedom
Residual deviance: 823573  on 671995  degrees of freedom
AIC: 823971

Number of Fisher Scoring iterations: 25